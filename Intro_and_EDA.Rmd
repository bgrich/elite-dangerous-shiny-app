---
title: "Introduction and EDA for EDDB"
author: "Brian Richards"
output: 
  html_notebook:
    toc: true
    toc_float: true
---

The Elite: Dangerous Database (EDDB) is a collection of data for the game 
Elite: Dangerous. The data is split into several different databases: 

* Prices of goods (listings.csv)
* Stations (stations.json)
* Populated Systems (systems_populated.json)
* Factions (factions,json)
* Commodities (commodities.json)
* Modules (modules.json)

This notebook will be an introduction to each data set and provide some 
exploratory data analysis of the data sets. This EDA will also act as 
prototypes for the information I will want to display in the Shiny app.

```{r, message = FALSE}
library(tidyverse)
```

## Prices

The `listings.csv` file gives a read out of the prices of goods at the time 
the file was updated.

```{r, message = FALSE}
listings <- read_csv("data/listings.csv", progress = FALSE)
```

```{r}
listings
```

The columns for the `listings` are:

* id: The id of the particular good
* station_id: The station where the good is being sold
* commodity_id: The good being sold (related to commodities.json)
* supply: How much of the item is available for purchase
* supply_bracket: Unsure of purpose
* buy_price: Price the good can be bought at 
* sell_price: Price the good can be sold at
* demand: How many items the station wants
* demand_bracket: Unsure of purpose
* collected_at: Time the data was collected

We can then look at a summary of the data to get an idea of what is in the 
data set.

```{r}
summary(listings)
```

From the summary, we can see that there are number of NA's in the `supply_bracket` 
and `demand_backet` columns. Since we don't know what those do, we can ignore 
those for the time being. Additionally, there are zeroes in the `sell_price` 
and `buy_price` columns. Those are essentially NA's as a `sell_price` of 0 means 
that you can't sell the product there and a `buy_price` of 0 means there are 
none available at that station.

```{r}
listings %>% 
  filter(commodity_id == 1) %>% 
  select(buy_price, sell_price) %>% 
  gather(type, price) %>% 
  filter(price > 0) %>% 
  group_by(type) %>% 
  mutate(average = mean(price), median = median(price)) %>% 
  ggplot(aes(x = price, fill = type)) +
  geom_histogram(bins = 100) +
  facet_grid(type ~.) +
  geom_vline(aes(xintercept = average)) +
  geom_vline(aes(xintercept = median), linetype = "dotted")
```

This figure gives a quick histogram of the buy and sell prices of a single 
commodity across all available stations. Note that it filters out any buy or 
sell prices of 0. The solid line is the mean of the distribution and the dotted 
line is the median of the distribution. From the figure, an interesting topic 
to investigate is looking at comparative buy and sell prices across stations 
to create a system to search for the max difference.
